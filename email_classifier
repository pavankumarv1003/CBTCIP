import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
from sklearn.preprocessing import LabelEncoder

df=pd.read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vSjT8X5-Yzwv6hsm97Y4MYSjhS7veqBcJKuSvI8SXCSpgi4gotdy4YsOqaz4nSAJhta1AuNPAqHPKo7/pub?output=csv")

data=df.where((pd.notnull(df)),'')  

encoder = LabelEncoder()  
data['v1'] = encoder.fit_transform(data['v1'])

X=data['v2']
Y=data['v1']

xtrain,xtest,ytrain,ytest=train_test_split(X,Y,test_size=0.2,random_state=3)

fx=TfidfVectorizer(min_df=1,stop_words='english',lowercase=True) 
xtrainf=fx.fit_transform(xtrain)
xtestf=fx.transform(xtest)

model=LogisticRegression()
model.fit(xtrainf,ytrain)

prediciton=model.predict(xtestf)
acc=accuracy_score(prediciton,ytest)
print("accuracy on evaluation :",acc)

ip=input("enter the message:")

ipf=fx.transform([ip])
fp=model.predict(ipf)
print(fp)

if fp[0]=='[0]':
    print("ham")
elif fp[0]==1:
    print("spam")

